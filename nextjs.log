
> agoramind@0.1.0 dev
> next dev --turbopack -H 0.0.0.0

   ▲ Next.js 15.2.4 (Turbopack)
   - Local:        http://localhost:3000
   - Network:      http://0.0.0.0:3000
   - Environments: .env.local

 ✓ Starting...
 ✓ Ready in 845ms
 ○ Compiling /_not-found/page ...
 GET /api/socket/io?EIO=4&transport=polling&t=5dht9lrv 404 in 2942ms
 GET /api/socket/io?EIO=4&transport=polling&t=5djagvm6 404 in 1242ms
 ✓ Compiled /_not-found/page in 3.2s
 GET /chat?id=5 200 in 1513ms
GET 요청 처리 - 쿼리: { id: '5' }
ID 5로 채팅룸 검색 중
 ○ Compiling /favicon.ico ...
검색 결과: 찾음
채팅룸 5 정보: {
  title: '유전자 편집 작물로 ‘기후 적응’—기회인가 프랑켄푸드인가',
  messagesCount: 53,
  lastMessageFrom: 'User_9221'
}
 GET /api/rooms?id=5 304 in 534ms
 GET /favicon.ico?favicon.45db1c09.ico 200 in 792ms
 ✓ Compiled /favicon.ico in 1273ms
🔍 Fetching NPC details for ID: e0c3872b-2103-4d04-8a2d-801bbd7f43cf
🔍 Searching by backend_id (UUID): e0c3872b-2103-4d04-8a2d-801bbd7f43cf
✅ Found custom NPC: Modern Socrates
   _id: 680ab82df57902e97ae4ef38, backend_id: not set
   portrait_url: http://localhost:8000/portraits/modern-socrates_1745532994.png
 GET /api/npc/get?id=e0c3872b-2103-4d04-8a2d-801bbd7f43cf 200 in 617ms
🔍 Fetching NPC details for ID: 655a4396-ef73-4e67-8ae6-c9f00f4a20ca
🔍 Searching by backend_id (UUID): 655a4396-ef73-4e67-8ae6-c9f00f4a20ca
✅ Found custom NPC: 빵빠라스
   _id: 6811406a9ba7d1076eba2e95, backend_id: not set
   portrait_url: http://localhost:8000/portraits/bbangbbaraseu_1745961092.png
 GET /api/npc/get?id=655a4396-ef73-4e67-8ae6-c9f00f4a20ca 200 in 24ms
🔍 Fetching NPC details for ID: marx
🔄 Trying backend API at http://0.0.0.0:8000/api/npc/get?id=marx
❌ Backend API 호출 오류: TypeError: fetch failed
    at async GET (src/app/api/npc/get/route.ts:95:30)
  93 |       // Python 백엔드 API 호출 시도
  94 |       console.log(`🔄 Trying backend API at ${BACKEND_API_URL}/api/npc/get?id=${id}`);
> 95 |       const backendResponse = await fetch(`${BACKEND_API_URL}/api/npc/get?id=${id}`, {
     |                              ^
  96 |         cache: 'no-store'
  97 |       });
  98 |        {
  [cause]: Error: connect ECONNREFUSED 0.0.0.0:8000
      at <unknown> (Error: connect ECONNREFUSED 0.0.0.0:8000) {
    errno: -61,
    code: 'ECONNREFUSED',
    syscall: 'connect',
    address: '0.0.0.0',
    port: 8000
  }
}
✅ Found local philosopher profile: Marx
 GET /api/npc/get?id=marx 200 in 103ms
🔍 Fetching NPC details for ID: kant
🔄 Trying backend API at http://0.0.0.0:8000/api/npc/get?id=kant
❌ Backend API 호출 오류: TypeError: fetch failed
    at async GET (src/app/api/npc/get/route.ts:95:30)
  93 |       // Python 백엔드 API 호출 시도
  94 |       console.log(`🔄 Trying backend API at ${BACKEND_API_URL}/api/npc/get?id=${id}`);
> 95 |       const backendResponse = await fetch(`${BACKEND_API_URL}/api/npc/get?id=${id}`, {
     |                              ^
  96 |         cache: 'no-store'
  97 |       });
  98 |        {
  [cause]: Error: connect ECONNREFUSED 0.0.0.0:8000
      at <unknown> (Error: connect ECONNREFUSED 0.0.0.0:8000) {
    errno: -61,
    code: 'ECONNREFUSED',
    syscall: 'connect',
    address: '0.0.0.0',
    port: 8000
  }
}
✅ Found local philosopher profile: Kant
 GET /api/npc/get?id=kant 200 in 64ms
🔍 Fetching NPC details for ID: e0c3872b-2103-4d04-8a2d-801bbd7f43cf
🔍 Searching by backend_id (UUID): e0c3872b-2103-4d04-8a2d-801bbd7f43cf
✅ Found custom NPC: Modern Socrates
   _id: 680ab82df57902e97ae4ef38, backend_id: not set
   portrait_url: http://localhost:8000/portraits/modern-socrates_1745532994.png
 GET /api/npc/get?id=e0c3872b-2103-4d04-8a2d-801bbd7f43cf 200 in 89ms
 ✓ Compiled /api/socket in 190ms
🔍 Fetching NPC details for ID: 655a4396-ef73-4e67-8ae6-c9f00f4a20ca
🔍 Searching by backend_id (UUID): 655a4396-ef73-4e67-8ae6-c9f00f4a20ca
✅ Found custom NPC: 빵빠라스
   _id: 6811406a9ba7d1076eba2e95, backend_id: not set
   portrait_url: http://localhost:8000/portraits/bbangbbaraseu_1745961092.png
 GET /api/npc/get?id=655a4396-ef73-4e67-8ae6-c9f00f4a20ca 200 in 166ms
🔍 Fetching NPC details for ID: e0c3872b-2103-4d04-8a2d-801bbd7f43cf
🔍 Searching by backend_id (UUID): e0c3872b-2103-4d04-8a2d-801bbd7f43cf
✅ Found custom NPC: Modern Socrates
   _id: 680ab82df57902e97ae4ef38, backend_id: not set
   portrait_url: http://localhost:8000/portraits/modern-socrates_1745532994.png
 GET /api/npc/get?id=e0c3872b-2103-4d04-8a2d-801bbd7f43cf 200 in 194ms
📁 socket.ts: .env.local 파일을 찾았습니다.
✅ socket.ts: .env.local 파일에서 설정을 로드했습니다.
socket.ts - API Key source: .env.local 파일
socket.ts - API Key check: sk-proj...svYA
Initializing socket server...
Socket.IO server initialized
 GET /api/socket 304 in 127ms
New client connected: lFHZ2aldAIBqAmeKAAAB
User User_9221 joined room 5
Getting active users for room: 5
🔍 Fetching NPC details for ID: marx
🔄 Trying backend API at http://0.0.0.0:8000/api/npc/get?id=marx
❌ Backend API 호출 오류: TypeError: fetch failed
    at async GET (src/app/api/npc/get/route.ts:95:30)
  93 |       // Python 백엔드 API 호출 시도
  94 |       console.log(`🔄 Trying backend API at ${BACKEND_API_URL}/api/npc/get?id=${id}`);
> 95 |       const backendResponse = await fetch(`${BACKEND_API_URL}/api/npc/get?id=${id}`, {
     |                              ^
  96 |         cache: 'no-store'
  97 |       });
  98 |        {
  [cause]: Error: connect ECONNREFUSED 0.0.0.0:8000
      at <unknown> (Error: connect ECONNREFUSED 0.0.0.0:8000) {
    errno: -61,
    code: 'ECONNREFUSED',
    syscall: 'connect',
    address: '0.0.0.0',
    port: 8000
  }
}
✅ Found local philosopher profile: Marx
 GET /api/npc/get?id=marx 200 in 179ms
🔍 Fetching NPC details for ID: 655a4396-ef73-4e67-8ae6-c9f00f4a20ca
🔍 Searching by backend_id (UUID): 655a4396-ef73-4e67-8ae6-c9f00f4a20ca
✅ Found custom NPC: 빵빠라스
   _id: 6811406a9ba7d1076eba2e95, backend_id: not set
   portrait_url: http://localhost:8000/portraits/bbangbbaraseu_1745961092.png
 GET /api/npc/get?id=655a4396-ef73-4e67-8ae6-c9f00f4a20ca 200 in 167ms
 GET /api/auth/session 200 in 2033ms
🔍 Fetching NPC details for ID: marx
🔄 Trying backend API at http://0.0.0.0:8000/api/npc/get?id=marx
❌ Backend API 호출 오류: TypeError: fetch failed
    at async GET (src/app/api/npc/get/route.ts:95:30)
  93 |       // Python 백엔드 API 호출 시도
  94 |       console.log(`🔄 Trying backend API at ${BACKEND_API_URL}/api/npc/get?id=${id}`);
> 95 |       const backendResponse = await fetch(`${BACKEND_API_URL}/api/npc/get?id=${id}`, {
     |                              ^
  96 |         cache: 'no-store'
  97 |       });
  98 |        {
  [cause]: Error: connect ECONNREFUSED 0.0.0.0:8000
      at <unknown> (Error: connect ECONNREFUSED 0.0.0.0:8000) {
    errno: -61,
    code: 'ECONNREFUSED',
    syscall: 'connect',
    address: '0.0.0.0',
    port: 8000
  }
}
✅ Found local philosopher profile: Marx
 GET /api/npc/get?id=marx 200 in 87ms
🔍 Fetching NPC details for ID: kant
🔄 Trying backend API at http://0.0.0.0:8000/api/npc/get?id=kant
❌ Backend API 호출 오류: TypeError: fetch failed
    at async GET (src/app/api/npc/get/route.ts:95:30)
  93 |       // Python 백엔드 API 호출 시도
  94 |       console.log(`🔄 Trying backend API at ${BACKEND_API_URL}/api/npc/get?id=${id}`);
> 95 |       const backendResponse = await fetch(`${BACKEND_API_URL}/api/npc/get?id=${id}`, {
     |                              ^
  96 |         cache: 'no-store'
  97 |       });
  98 |        {
  [cause]: Error: connect ECONNREFUSED 0.0.0.0:8000
      at <unknown> (Error: connect ECONNREFUSED 0.0.0.0:8000) {
    errno: -61,
    code: 'ECONNREFUSED',
    syscall: 'connect',
    address: '0.0.0.0',
    port: 8000
  }
}
✅ Found local philosopher profile: Kant
 GET /api/npc/get?id=kant 200 in 121ms
🔍 Fetching NPC details for ID: kant
🔄 Trying backend API at http://0.0.0.0:8000/api/npc/get?id=kant
❌ Backend API 호출 오류: TypeError: fetch failed
    at async GET (src/app/api/npc/get/route.ts:95:30)
  93 |       // Python 백엔드 API 호출 시도
  94 |       console.log(`🔄 Trying backend API at ${BACKEND_API_URL}/api/npc/get?id=${id}`);
> 95 |       const backendResponse = await fetch(`${BACKEND_API_URL}/api/npc/get?id=${id}`, {
     |                              ^
  96 |         cache: 'no-store'
  97 |       });
  98 |        {
  [cause]: Error: connect ECONNREFUSED 0.0.0.0:8000
      at <unknown> (Error: connect ECONNREFUSED 0.0.0.0:8000) {
    errno: -61,
    code: 'ECONNREFUSED',
    syscall: 'connect',
    address: '0.0.0.0',
    port: 8000
  }
}
✅ Found local philosopher profile: Kant
 GET /api/npc/get?id=kant 200 in 46ms
 GET /chat?id=5 200 in 58ms
Client disconnected: lFHZ2aldAIBqAmeKAAAB
 GET /favicon.ico?favicon.45db1c09.ico 200 in 68ms
GET 요청 처리 - 쿼리: { id: '5' }
ID 5로 채팅룸 검색 중
검색 결과: 찾음
채팅룸 5 정보: {
  title: '유전자 편집 작물로 ‘기후 적응’—기회인가 프랑켄푸드인가',
  messagesCount: 53,
  lastMessageFrom: 'User_9221'
}
 GET /api/rooms?id=5 304 in 24ms
 GET /api/auth/session 200 in 63ms
🔍 Fetching NPC details for ID: e0c3872b-2103-4d04-8a2d-801bbd7f43cf
🔍 Searching by backend_id (UUID): e0c3872b-2103-4d04-8a2d-801bbd7f43cf
✅ Found custom NPC: Modern Socrates
   _id: 680ab82df57902e97ae4ef38, backend_id: not set
   portrait_url: http://localhost:8000/portraits/modern-socrates_1745532994.png
 GET /api/npc/get?id=e0c3872b-2103-4d04-8a2d-801bbd7f43cf 200 in 19ms
🔍 Fetching NPC details for ID: 655a4396-ef73-4e67-8ae6-c9f00f4a20ca
🔍 Searching by backend_id (UUID): 655a4396-ef73-4e67-8ae6-c9f00f4a20ca
✅ Found custom NPC: 빵빠라스
   _id: 6811406a9ba7d1076eba2e95, backend_id: not set
   portrait_url: http://localhost:8000/portraits/bbangbbaraseu_1745961092.png
 GET /api/npc/get?id=655a4396-ef73-4e67-8ae6-c9f00f4a20ca 200 in 19ms
🔍 Fetching NPC details for ID: marx
🔄 Trying backend API at http://0.0.0.0:8000/api/npc/get?id=marx
❌ Backend API 호출 오류: TypeError: fetch failed
    at async GET (src/app/api/npc/get/route.ts:95:30)
  93 |       // Python 백엔드 API 호출 시도
  94 |       console.log(`🔄 Trying backend API at ${BACKEND_API_URL}/api/npc/get?id=${id}`);
> 95 |       const backendResponse = await fetch(`${BACKEND_API_URL}/api/npc/get?id=${id}`, {
     |                              ^
  96 |         cache: 'no-store'
  97 |       });
  98 |        {
  [cause]: Error: connect ECONNREFUSED 0.0.0.0:8000
      at <unknown> (Error: connect ECONNREFUSED 0.0.0.0:8000) {
    errno: -61,
    code: 'ECONNREFUSED',
    syscall: 'connect',
    address: '0.0.0.0',
    port: 8000
  }
}
✅ Found local philosopher profile: Marx
 GET /api/npc/get?id=marx 200 in 50ms
🔍 Fetching NPC details for ID: kant
🔄 Trying backend API at http://0.0.0.0:8000/api/npc/get?id=kant
❌ Backend API 호출 오류: TypeError: fetch failed
    at async GET (src/app/api/npc/get/route.ts:95:30)
  93 |       // Python 백엔드 API 호출 시도
  94 |       console.log(`🔄 Trying backend API at ${BACKEND_API_URL}/api/npc/get?id=${id}`);
> 95 |       const backendResponse = await fetch(`${BACKEND_API_URL}/api/npc/get?id=${id}`, {
     |                              ^
  96 |         cache: 'no-store'
  97 |       });
  98 |        {
  [cause]: Error: connect ECONNREFUSED 0.0.0.0:8000
      at <unknown> (Error: connect ECONNREFUSED 0.0.0.0:8000) {
    errno: -61,
    code: 'ECONNREFUSED',
    syscall: 'connect',
    address: '0.0.0.0',
    port: 8000
  }
}
✅ Found local philosopher profile: Kant
 GET /api/npc/get?id=kant 200 in 55ms
Socket server already running
 GET /api/socket 304 in 64ms
New client connected: XUyRGxrDuVo1g0RmAAAD
User User_9221 joined room 5
Getting active users for room: 5
🔍 Fetching NPC details for ID: e0c3872b-2103-4d04-8a2d-801bbd7f43cf
🔍 Searching by backend_id (UUID): e0c3872b-2103-4d04-8a2d-801bbd7f43cf
✅ Found custom NPC: Modern Socrates
   _id: 680ab82df57902e97ae4ef38, backend_id: not set
   portrait_url: http://localhost:8000/portraits/modern-socrates_1745532994.png
 GET /api/npc/get?id=e0c3872b-2103-4d04-8a2d-801bbd7f43cf 200 in 249ms
🔍 Fetching NPC details for ID: e0c3872b-2103-4d04-8a2d-801bbd7f43cf
🔍 Searching by backend_id (UUID): e0c3872b-2103-4d04-8a2d-801bbd7f43cf
✅ Found custom NPC: Modern Socrates
   _id: 680ab82df57902e97ae4ef38, backend_id: not set
   portrait_url: http://localhost:8000/portraits/modern-socrates_1745532994.png
 GET /api/npc/get?id=e0c3872b-2103-4d04-8a2d-801bbd7f43cf 200 in 37ms
🔍 Fetching NPC details for ID: 655a4396-ef73-4e67-8ae6-c9f00f4a20ca
🔍 Searching by backend_id (UUID): 655a4396-ef73-4e67-8ae6-c9f00f4a20ca
✅ Found custom NPC: 빵빠라스
   _id: 6811406a9ba7d1076eba2e95, backend_id: not set
   portrait_url: http://localhost:8000/portraits/bbangbbaraseu_1745961092.png
 GET /api/npc/get?id=655a4396-ef73-4e67-8ae6-c9f00f4a20ca 200 in 23ms
🔍 Fetching NPC details for ID: 655a4396-ef73-4e67-8ae6-c9f00f4a20ca
🔍 Searching by backend_id (UUID): 655a4396-ef73-4e67-8ae6-c9f00f4a20ca
🔍 Fetching NPC details for ID: marx
🔄 Trying backend API at http://0.0.0.0:8000/api/npc/get?id=marx
✅ Found custom NPC: 빵빠라스
   _id: 6811406a9ba7d1076eba2e95, backend_id: not set
   portrait_url: http://localhost:8000/portraits/bbangbbaraseu_1745961092.png
 GET /api/npc/get?id=655a4396-ef73-4e67-8ae6-c9f00f4a20ca 200 in 26ms
❌ Backend API 호출 오류: TypeError: fetch failed
    at async GET (src/app/api/npc/get/route.ts:95:30)
  93 |       // Python 백엔드 API 호출 시도
  94 |       console.log(`🔄 Trying backend API at ${BACKEND_API_URL}/api/npc/get?id=${id}`);
> 95 |       const backendResponse = await fetch(`${BACKEND_API_URL}/api/npc/get?id=${id}`, {
     |                              ^
  96 |         cache: 'no-store'
  97 |       });
  98 |        {
  [cause]: Error: connect ECONNREFUSED 0.0.0.0:8000
      at <unknown> (Error: connect ECONNREFUSED 0.0.0.0:8000) {
    errno: -61,
    code: 'ECONNREFUSED',
    syscall: 'connect',
    address: '0.0.0.0',
    port: 8000
  }
}
✅ Found local philosopher profile: Marx
 GET /api/npc/get?id=marx 200 in 56ms
🔍 Fetching NPC details for ID: marx
🔄 Trying backend API at http://0.0.0.0:8000/api/npc/get?id=marx
❌ Backend API 호출 오류: TypeError: fetch failed
    at async GET (src/app/api/npc/get/route.ts:95:30)
  93 |       // Python 백엔드 API 호출 시도
  94 |       console.log(`🔄 Trying backend API at ${BACKEND_API_URL}/api/npc/get?id=${id}`);
> 95 |       const backendResponse = await fetch(`${BACKEND_API_URL}/api/npc/get?id=${id}`, {
     |                              ^
  96 |         cache: 'no-store'
  97 |       });
  98 |        {
  [cause]: Error: connect ECONNREFUSED 0.0.0.0:8000
      at <unknown> (Error: connect ECONNREFUSED 0.0.0.0:8000) {
    errno: -61,
    code: 'ECONNREFUSED',
    syscall: 'connect',
    address: '0.0.0.0',
    port: 8000
  }
}
✅ Found local philosopher profile: Marx
 GET /api/npc/get?id=marx 200 in 60ms
🔍 Fetching NPC details for ID: kant
🔄 Trying backend API at http://0.0.0.0:8000/api/npc/get?id=kant
❌ Backend API 호출 오류: TypeError: fetch failed
    at async GET (src/app/api/npc/get/route.ts:95:30)
  93 |       // Python 백엔드 API 호출 시도
  94 |       console.log(`🔄 Trying backend API at ${BACKEND_API_URL}/api/npc/get?id=${id}`);
> 95 |       const backendResponse = await fetch(`${BACKEND_API_URL}/api/npc/get?id=${id}`, {
     |                              ^
  96 |         cache: 'no-store'
  97 |       });
  98 |        {
  [cause]: Error: connect ECONNREFUSED 0.0.0.0:8000
      at <unknown> (Error: connect ECONNREFUSED 0.0.0.0:8000) {
    errno: -61,
    code: 'ECONNREFUSED',
    syscall: 'connect',
    address: '0.0.0.0',
    port: 8000
  }
}
✅ Found local philosopher profile: Kant
 GET /api/npc/get?id=kant 200 in 92ms
🔍 Fetching NPC details for ID: kant
🔄 Trying backend API at http://0.0.0.0:8000/api/npc/get?id=kant
❌ Backend API 호출 오류: TypeError: fetch failed
    at async GET (src/app/api/npc/get/route.ts:95:30)
  93 |       // Python 백엔드 API 호출 시도
  94 |       console.log(`🔄 Trying backend API at ${BACKEND_API_URL}/api/npc/get?id=${id}`);
> 95 |       const backendResponse = await fetch(`${BACKEND_API_URL}/api/npc/get?id=${id}`, {
     |                              ^
  96 |         cache: 'no-store'
  97 |       });
  98 |        {
  [cause]: Error: connect ECONNREFUSED 0.0.0.0:8000
      at <unknown> (Error: connect ECONNREFUSED 0.0.0.0:8000) {
    errno: -61,
    code: 'ECONNREFUSED',
    syscall: 'connect',
    address: '0.0.0.0',
    port: 8000
  }
}
✅ Found local philosopher profile: Kant
 GET /api/npc/get?id=kant 200 in 57ms
[?25h
